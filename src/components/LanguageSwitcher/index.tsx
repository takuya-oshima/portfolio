"use client";

import { useRouter } from "next/navigation";
import { useLocale } from "next-intl";
import { useState } from "react";

export default function LanguageSwitcher() {
  const router = useRouter();
  const currentLocale = useLocale(); // 現在のロケールを取得
  const defaultLocale = "ja"; // デフォルトロケール
  const newLocale = currentLocale === "ja" ? "en" : "ja"; // 切り替え先の言語

  // 言語を切り替える関数
  const languageChange = () => {
    const path = window.location.pathname; // 現在のパスを取得
    let newPath = "";

    if (newLocale === defaultLocale) {
      // デフォルトロケール（ja）に切り替え → /ja を削除
      newPath = path.replace(/^\/en/, "") || "/";
    } else {
      // 英語（en）に切り替え → /en を追加
      newPath = `/en${path}`;
    }

    router.push(newPath);
  };

  //言語アイコンをクリックした時の挙動
  const [openLanguage, setOpenLanguage] = useState<boolean>(false);
  const languageFunction = () => {
    setOpenLanguage(!openLanguage);
  };

  return (
    <div className="w-6 h-6 relative cursor-pointer">
      <div onClick={languageFunction}>
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" fillRule="evenodd"><path d="M21.5281 4.72485C21.521 4.71464 21.5098 4.70979 21.5023 4.70004C20.3865 3.23871 18.9486 2.05442 17.3006 1.23925C15.6525 0.424089 13.8387 1.30612e-05 12.0001 3.01699e-10C10.1615 -1.30605e-05 8.34761 0.424037 6.69956 1.23918C5.05151 2.05432 3.61367 3.23859 2.49783 4.69991C2.49033 4.7097 2.47902 4.71455 2.47193 4.72485C2.46703 4.73195 2.46675 4.74047 2.46213 4.74765C0.865462 6.82816 0 9.37744 0 12C0 14.6226 0.865462 17.1719 2.46213 19.2524C2.46675 19.2595 2.46703 19.2681 2.47193 19.2752C2.47898 19.2854 2.49023 19.2902 2.4977 19.2999C3.61392 20.7618 5.05239 21.9464 6.70119 22.7616C8.34999 23.5768 10.1646 24.0006 12.004 24C13.8433 23.9994 15.6576 23.5744 17.3059 22.7581C18.9541 21.9418 20.3918 20.7562 21.5071 19.2935C21.5129 19.2858 21.5225 19.2832 21.5281 19.2751C21.533 19.268 21.5332 19.2595 21.5379 19.2523C23.1345 17.1718 24 14.6226 24 12C24 9.37742 23.1345 6.82815 21.5379 4.74764C21.5333 4.74047 21.533 4.73195 21.5281 4.72485ZM20.7164 17.8467C19.9283 17.3841 19.0939 17.0052 18.227 16.7162C18.5234 15.4137 18.6917 14.0853 18.7294 12.75H22.462C22.3364 14.5725 21.7345 16.33 20.7164 17.8467ZM1.538 12.75H5.27065C5.30832 14.0853 5.47659 15.4137 5.77304 16.7162C4.90607 17.0052 4.0717 17.3841 3.28358 17.8467C2.26552 16.33 1.66358 14.5725 1.538 12.75ZM3.28358 6.15327C4.0717 6.6159 4.90607 6.99481 5.77304 7.2838C5.47659 8.58631 5.30832 9.91471 5.27065 11.25H1.538C1.66358 9.42756 2.26552 7.67004 3.28358 6.15327ZM12.75 8.22684C14.103 8.18498 15.4483 8.00754 16.7659 7.69716C17.033 8.86404 17.1885 10.0537 17.2303 11.25H12.75V8.22684ZM12.75 6.7275V1.62543C14.2388 2.07413 15.547 3.81768 16.3633 6.25518C15.1771 6.52946 13.9669 6.68764 12.75 6.7275ZM11.25 1.62543V6.7275C10.0331 6.68766 8.82296 6.52949 7.63669 6.25523C8.45297 3.8177 9.76125 2.07413 11.25 1.62543ZM11.25 8.22684V11.25H6.76969C6.8115 10.0537 6.96702 8.86404 7.23413 7.69716C8.55168 8.00754 9.89704 8.18498 11.25 8.22684ZM6.76969 12.75H11.25V15.7732C9.89704 15.815 8.55168 15.9925 7.23413 16.3029C6.96702 15.136 6.8115 13.9463 6.76969 12.75ZM11.25 17.2725V22.3746C9.76125 21.9259 8.45297 20.1823 7.63669 17.7448C8.82296 17.4705 10.0331 17.3124 11.25 17.2725ZM12.75 22.3746V17.2725C13.9669 17.3124 15.1771 17.4705 16.3633 17.7448C15.547 20.1823 14.2388 21.9259 12.75 22.3746ZM12.75 15.7731V12.75H17.2303C17.1885 13.9463 17.033 15.136 16.7659 16.3029C15.4483 15.9925 14.103 15.815 12.75 15.7731ZM18.7294 11.25C18.6917 9.91471 18.5234 8.58631 18.227 7.2838C19.0939 6.99481 19.9283 6.6159 20.7164 6.15327C21.7345 7.67004 22.3364 9.42756 22.462 11.25H18.7294ZM19.7779 4.97127C19.1519 5.32235 18.4949 5.61527 17.8154 5.84633C17.4158 4.5711 16.805 3.37199 16.0084 2.29898C17.4472 2.89969 18.7347 3.81242 19.7779 4.97127ZM7.99166 2.29898C7.19505 3.37198 6.5842 4.57109 6.18458 5.84633C5.50503 5.61527 4.84811 5.32235 4.22207 4.97127C5.26528 3.81242 6.55278 2.89969 7.99166 2.29898ZM4.2221 19.0287C4.84814 18.6777 5.50506 18.3848 6.18461 18.1537C6.58423 19.4289 7.19508 20.628 7.99169 21.701C6.55282 21.1003 5.2653 20.1876 4.2221 19.0287ZM16.0083 21.701C16.8049 20.628 17.4158 19.4289 17.8154 18.1537C18.4949 18.3848 19.1519 18.6777 19.7779 19.0287C18.7347 20.1876 17.4472 21.1003 16.0083 21.701Z" fill="black"/></svg>
      </div>
      <div className={`${ openLanguage ? "block" : "hidden"} grid place-content-center gap-y-2.5 mt-6`}>
        <div onClick={languageChange} className="text-base text-center cursor-pointer">
          {currentLocale === "ja" ? "ENGLISH" : "JAPANESE"}
        </div>
      </div>
    </div>
  );
}
